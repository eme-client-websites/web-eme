---
import Layout from '../layouts/Layout.astro';
import MobileHeader from '../components/MobileHeader.astro';
import Servicios from '../components/Servicios.astro';
import Contadores from '../components/Contadores.astro';
import Proyectos from '../components/Proyectos.astro';
import MapaGlobal from '../components/MapaGlobal.astro';
import Equipo from '../components/Equipo.astro';
import Footer from '../components/Footer.astro';
import ClientesShowcase from '../components/ClientesShowcase.astro';
import PartnersShowcase from '../components/PartnersShowcase.astro';
import MenuNavegacion from '../components/MenuNavegacion.astro';
import MenuScrollDesktop from '../components/MenuScrollDesktop.astro';
import { getLangFromUrl, useTranslations } from '../i18n/utils';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<Layout title="Mi Proyecto Web - Astro + React + Tailwind">
	<!-- Header móvil -->
	<MobileHeader />
	
	<!-- Estilos CSS para la transición de colores -->
	<style>
		/* Variables CSS por defecto - Estado inicial */
		:root {
			--text-color: #000000;
		}

		body {
			min-height: calc(-90px + 100vh);
			cursor: auto;
		}

		/* Estado azul */
		body[data-color="blue"] {
			--text-color: #ffffff;
		}

		/* Estado azul profundo */
		body[data-color="blue-deep"] {
			--text-color: #ffffff;
		}

		/* Estado gris */
		body[data-color="gray"] {
			--text-color: #000000;
		}

		.transition-colors {
			transition-property: color, background-color, border-color, text-decoration-color, fill, stroke;
			transition-timing-function: cubic-bezier(.4,0,.2,1);
			transition-duration: .15s;
		}

		.ease-in-out {
			transition-timing-function: cubic-bezier(.4,0,.2,1);
		}

		.duration-300 {
			transition-duration: .3s;
		}

		/* Clase dinámica para texto */
		.dynamic-text {
			color: var(--text-color) !important;
			transition-property: color;
			transition-timing-function: cubic-bezier(.4,0,.2,1);
			transition-duration: .3s;
		}

		/* Footer siempre blanco - forzado */
		footer {
			background-color: #ffffff !important;
			background: #ffffff !important;
			color: #000000 !important;
		}

		footer .dynamic-text,
		footer .dynamic-text *,
		footer *,
		footer a,
		footer span,
		footer p,
		footer h1,
		footer h2,
		footer h3,
		footer h4,
		footer h5,
		footer h6,
		footer div {
			color: #000000 !important;
			background-color: transparent !important;
		}

		footer svg {
			color: #000000 !important;
			fill: #000000 !important;
		}
	</style>

	<!-- Navegación -->
	<nav class="absolute top-0 w-full bg-transparent z-20">
		<div class="container-custom">
			<div class="flex justify-between items-center h-16">
			</div>
		</div>
	</nav>

	<!-- Hero Section -->
	<section id="inicio" class="min-h-screen flex items-center justify-center relative overflow-hidden">
		<!-- Imagen de fondo -->
		<div class="absolute inset-0 z-0">
			<img src="/fondohero.jpg" alt="Hero Background" class="w-full h-full object-cover" />
			<!-- Overlay oscuro para legibilidad -->
			<div class="absolute inset-0 bg-gradient-to-b from-black/70 via-black/60 to-black/80"></div>
		</div>
		
		<!-- Efectos de luz sutiles sobre la imagen -->
		<div class="absolute top-0 left-1/4 w-96 h-96 bg-[#0043FF] rounded-full mix-blend-screen filter blur-3xl opacity-5 z-10"></div>
		<div class="absolute bottom-0 right-1/4 w-96 h-96 bg-[#0033C4] rounded-full mix-blend-screen filter blur-3xl opacity-5 z-10"></div>
		
		<!-- Efecto de luz central sutil -->
		<div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-gradient-to-r from-[#0043FF] to-[#0033C4] rounded-full mix-blend-screen filter blur-2xl opacity-3 z-10"></div>
		
		<div class="relative z-20 flex items-center h-full w-full px-0">
			<!-- Columna izquierda: Contenido principal (70%) -->
			<div class="w-full md:w-[70%] text-left px-4 md:pl-[40px] md:pr-0">

			<!-- Título principal -->
			<h1 class="text-4xl md:text-7xl font-bold text-white mb-6 leading-none -mt-80 uppercase text-left">
				{t('hero.title') || 'CRECEMOS MARCAS CON'}
			</br><span class="text-white">
					{t('hero.titleHighlight') || ' ESTRATEGIA Y TECNOLOGÍA'}
				</span>
			</h1>

			</div>
			
			<!-- Columna derecha: Menú de navegación (35%) -->
			<div class="w-[35%] hidden xl:flex flex-col justify-center items-end pr-8 mt-16">
				<MenuNavegacion />
			</div>
		</div>
		
		<!-- Scroll Indicator Premium -->
		<div class="absolute bottom-8 left-1/2 transform -translate-x-1/2 z-20 cursor-pointer group" onclick="document.getElementById('contadores').scrollIntoView({behavior: 'smooth'})">
			<div class="flex flex-col items-center space-y-3">
				
				
				<!-- Contenedor del scroll indicator -->
				<div class="relative w-8 h-16 bg-white/10 backdrop-blur-sm rounded-full border border-white/20 group-hover:border-white/40 transition-all duration-300 flex items-start justify-center">
					<!-- Bolita animada dentro -->
					<div class="absolute top-3 w-3 h-3 bg-white rounded-full scroll-dot shadow-lg"></div>
				</div>
				
				<!-- Flecha minimalista -->
				<div class="text-white/30 group-hover:text-white/50 transition-colors duration-300">
					<svg class="w-4 h-4 animate-bounce" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 14l-7 7m0 0l-7-7"/>
					</svg>
				</div>
			</div>
		</div>
		
		<style>
			@keyframes scrollDot {
				0% {
					transform: translateY(0);
					opacity: 1;
				}
				50% {
					transform: translateY(36px);
					opacity: 0.4;
				}
				100% {
					transform: translateY(0);
					opacity: 1;
				}
			}
			
			.scroll-dot {
				animation: scrollDot 2.5s infinite ease-in-out;
			}
		</style>
	</section>

	<!-- Sección de Contadores -->
	<div id="contadores">
		<Contadores />
	</div>

	<!-- Sección de Mapa Global -->
	<MapaGlobal />

	<!-- Sección de Servicios -->
	<div id="servicios">
		<Servicios />
	</div>

	<!-- Sección de Proyectos -->
	<div id="proyectos">
		<Proyectos />
	</div>
<!-- Showcase de Clientes -->
<ClientesShowcase />
	


	<!-- Sección de Equipo -->
	<div id="equipo">
		<Equipo />
	</div>

	<!-- Sección de Partners -->
	<PartnersShowcase />

	<!-- Footer -->
	<Footer />


	<!-- Menú Desktop para Scroll -->
	<MenuScrollDesktop />

	<!-- Script para manejar la transición de colores basada en scroll -->
	<script>
		function forceFooterWhite() {
			// Forzar footer blanco siempre
			const footer = document.querySelector('footer');
			if (footer) {
				footer.style.backgroundColor = '#ffffff';
				footer.style.background = '#ffffff';
				footer.style.color = '#000000';
				
				const footerElements = footer.querySelectorAll('*');
				footerElements.forEach(el => {
					(el as HTMLElement).style.color = '#000000';
					(el as HTMLElement).style.backgroundColor = 'transparent';
				});
			}
		}

		function updateColors() {
			const scrollY = window.scrollY;
			const documentHeight = document.documentElement.scrollHeight - window.innerHeight;
			const scrollPercent = (scrollY / documentHeight) * 100;
			
			console.log('ScrollY:', scrollY, 'Scroll %:', scrollPercent.toFixed(1));
			
			// Test directo con elementos (excluyendo footer)
			const dynamicTexts = document.querySelectorAll('.dynamic-text:not(footer .dynamic-text):not(footer *)');
			console.log('Elementos encontrados:', dynamicTexts.length);
			
			if (scrollPercent <= 8) {
				// Estado 1: texto negro, fondo gris niebla #F1F1F1 (0% - 8%)
				document.body.setAttribute('data-color', 'gray');
				document.body.removeAttribute('data-header');
				document.body.style.background = '';
				document.body.style.backgroundColor = '#F1F1F1'; // FONDO GRIS NIEBLA #F1F1F1
				dynamicTexts.forEach(el => {
					(el as HTMLElement).style.color = '#000000'; // Texto negro
				});
				console.log('Aplicado: NEGRO sobre GRIS NIEBLA #F1F1F1 (0%-8%)');
			} else if (scrollPercent <= 20) {
				// Estado 2: texto blanco, fondo azul #0043FF (8% - 20%)
				document.body.setAttribute('data-color', 'blue');
				document.body.setAttribute('data-header', 'white');
				document.body.style.background = '';
				document.body.style.backgroundColor = '#0043FF'; // FONDO AZUL #0043FF
				dynamicTexts.forEach(el => {
					(el as HTMLElement).style.color = '#ffffff'; // Texto blanco
				});
				console.log('Aplicado: BLANCO sobre AZUL #0043FF (8%-20%)');
			} else if (scrollPercent <= 45) {
				// Estado 3: texto blanco, fondo azul profundo #030B46 (20% - 45%)
				document.body.setAttribute('data-color', 'blue-deep');
				document.body.setAttribute('data-header', 'white');
				document.body.style.background = '';
				document.body.style.backgroundColor = '#030B46'; // FONDO AZUL PROFUNDO #030B46
				dynamicTexts.forEach(el => {
					(el as HTMLElement).style.color = '#ffffff'; // Texto blanco
				});
				console.log('Aplicado: BLANCO sobre AZUL PROFUNDO #030B46 (20%-45%)');
			} else if (scrollPercent <= 75) {
				// Estado 4: texto negro, fondo gris niebla #F1F1F1 (45% - 75%)
				document.body.setAttribute('data-color', 'gray');
				document.body.removeAttribute('data-header');
				document.body.style.background = '';
				document.body.style.backgroundColor = '#F1F1F1'; // FONDO GRIS NIEBLA #F1F1F1
				dynamicTexts.forEach(el => {
					(el as HTMLElement).style.color = '#000000'; // Texto negro
				});
				console.log('Aplicado: NEGRO sobre GRIS NIEBLA #F1F1F1 (45%-75%)');
			} else if (scrollPercent <= 85) {
				// Estado 5: texto blanco, fondo azul #0043FF (75% - 85%)
				document.body.setAttribute('data-color', 'blue');
				document.body.setAttribute('data-header', 'white');
				document.body.style.background = '';
				document.body.style.backgroundColor = '#0043FF'; // FONDO AZUL #0043FF
				dynamicTexts.forEach(el => {
					(el as HTMLElement).style.color = '#ffffff'; // Texto blanco
				});
				console.log('Aplicado: BLANCO sobre AZUL #0043FF (75%-85%)');
			} else if (scrollPercent <= 95) {
				// Estado 6: texto blanco, fondo azul profundo #030B46 (85% - 95%)
				document.body.setAttribute('data-color', 'blue-deep');
				document.body.setAttribute('data-header', 'white');
				document.body.style.background = '';
				document.body.style.backgroundColor = '#030B46'; // FONDO AZUL PROFUNDO #030B46
				dynamicTexts.forEach(el => {
					(el as HTMLElement).style.color = '#ffffff'; // Texto blanco
				});
				console.log('Aplicado: BLANCO sobre AZUL PROFUNDO #030B46 (85%-95%)');
			} else {
				// Estado 7: texto negro, fondo blanco #ffffff (95% - 100%)
				document.body.removeAttribute('data-color');
				document.body.removeAttribute('data-header');
				document.body.style.background = '';
				document.body.style.backgroundColor = '#ffffff'; // FONDO BLANCO #ffffff
				dynamicTexts.forEach(el => {
					(el as HTMLElement).style.color = '#000000'; // Texto negro
				});
				console.log('Aplicado: NEGRO sobre BLANCO #ffffff (95%-100%)');
			}
			
			// Forzar footer blanco después de cada cambio
			forceFooterWhite();
		}

		// Ejecutar cuando el DOM esté listo
		document.addEventListener('DOMContentLoaded', function() {
			console.log('DOM cargado');
			window.addEventListener('scroll', updateColors);
			updateColors(); // Ejecutar una vez al cargar
		});
	</script>
</Layout>
